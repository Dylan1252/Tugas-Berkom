<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vending Machine - Tugas Berkom</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Vending Machine</h1>
      <p class="subtitle">Tugas Besar Komunikasi Data</p>
    </header>

    <main>
      <section id="productList"></section>

      <section id="inputSection" class="hidden">
        <p id="selectedProduct"></p>
        <label for="uangInput">Masukkan uang (Rp):</label>
        <input type="number" id="uangInput" min="0" placeholder="Contoh: 5000">
        <button id="btnMasukkan" onclick="masukkanUang()">Masukkan</button>
      </section>

      <div id="console" class="console"></div>
    </main>
  </div>

  <script>
    const products = {
      1: { name: "Cola", price: 5000, stock: 5 },
      2: { name: "Air Mineral", price: 3000, stock: 10 },
      3: { name: "Cokelat", price: 8000, stock: 3 },
      4: { name: "Keripik", price: 6000, stock: 7 }
    };

    let uangMasuk = 0;
    let selected = null;
    const logBox = document.getElementById("console");

    function tampilkanProduk() {
      const list = document.getElementById("productList");
      list.innerHTML = "";
      for (let id in products) {
        const p = products[id];
        const div = document.createElement("div");
        div.className = "product";
        div.innerHTML = `
          <div class="product-info">
            <div>
              <h3>${p.name}</h3>
              <p>Rp${p.price.toLocaleString()}</p>
              <p class="stock">Stok: ${p.stock}</p>
            </div>
            <button class="btn" onclick="pilihProduk(${id})">Pilih</button>
          </div>
        `;
        list.appendChild(div);
      }
    }

    function log(msg) {
      logBox.textContent += msg + "\n";
      logBox.scrollTop = logBox.scrollHeight;
    }

    function pilihProduk(id) {
      const p = products[id];
      if (p.stock <= 0) {
        log(`âŒ Stok ${p.name} habis.`);
        return;
      }
      selected = p;
      uangMasuk = 0;
      document.getElementById("inputSection").classList.remove("hidden");
      document.getElementById("selectedProduct").textContent =
        `Produk dipilih: ${p.name} - Harga Rp${p.price.toLocaleString()}`;
      log(`ðŸ›’ Anda memilih ${p.name}. Masukkan uang.`);
    }

    function masukkanUang() {
      const input = document.getElementById("uangInput");
      const uang = parseInt(input.value);
      if (isNaN(uang) || uang <= 0) {
        log("âš ï¸ Nominal uang tidak valid.");
        return;
      }

      uangMasuk += uang;
      log(`ðŸ’° Total uang dimasukkan: Rp${uangMasuk.toLocaleString()}`);

      if (uangMasuk < selected.price) {
        log(`ðŸ”¹ Uang kurang Rp${(selected.price - uangMasuk).toLocaleString()}.`);
      } else {
        const kembalian = uangMasuk - selected.price;
        selected.stock -= 1;
        log(`âœ… Produk ${selected.name} telah keluar.`);
        if (kembalian > 0) log(`ðŸ”¸ Kembalian Anda: Rp${kembalian.toLocaleString()}`);
        log("Terima kasih telah bertransaksi.\n");
        uangMasuk = 0;
        document.getElementById("inputSection").classList.add("hidden");
        tampilkanProduk();
      }
      input.value = "";
    }

    tampilkanProduk();
    log("Selamat datang di Vending Machine!");
  </script>
</body>
</html>
